%% 采用DH法对五轴系统进行建模
%以下参数具体数值需要在设备上实测
clear
clc
%%
offsetBAZ = 50;    %B轴与A轴在z方向的距离
offsetBAX = 25;     %B轴与A轴在x方向的距离
%以下四个参数导致了刀具末端的偏移
offsetAToolZ = 100;  %A轴与工具末端在z方向的距离
offsetAToolY = 10;  %A轴与工具在y方向的距离
water_depth = 0;
lengthOfTool = offsetAToolZ + water_depth;%为末端沿Z方向的长度

%% DH table
%link  a            alf   d          theta
% 1   jx            0     0             0
% 2   0             0     jz            0
% 3   0            -90    0             0
% 4   0             0     jy            0
% 5   0             0     0             jb
% 6   0             90    0             0
% 7   0             0     -offsetBAZ    0
% 8   -offsetBAX    0     0             0
% 9   0             ja    0             0
% 10  0             0     -lengthOfTool 0
% 11  0             90    0             0
% 12  0             0     offsetAToolY  0
% 13  0             -90   0             0


%%
% syms jx jy jz ja jb
jx = 0;
jy = 0;
jz = 0;
ja = 0;
jb = 0;
a = jx;
A1 = [1 0 0 a;...
      0 1 0 0;...
      0 0 1 0;...
      0 0 0 1];
d = jz;
A2 = [1 0 0 0;...
      0 1 0 0;...
      0 0 1 d;...
      0 0 0 1];
alf = -90;
A3 = [1 0          0         0;...
      0 cosd(alf),  -sind(alf) 0;...
      0 sind(alf), cosd(alf)  0;...
      0 0          0         1];
d = jy;
A4 = [1 0 0 0;...
      0 1 0 0;...
      0 0 1 d;...
      0 0 0 1];
theta = jb;
A5 = [cosd(theta),-sind(theta),0,0;...
      sind(theta),cosd(theta), 0,0;...
      0          0           1 0;...
      0          0           0 1];
alf = 90;
A6 = [1 0          0         0;...
      0 cosd(alf),  -sind(alf) 0;...
      0 sind(alf), cosd(alf)  0;...
      0 0          0         1];
d = -offsetBAZ;
A7 = [1 0 0 0;...
      0 1 0 0;...
      0 0 1 d;...
      0 0 0 1];
a = -offsetBAX;
A8 = [1 0 0 a;...
      0 1 0 0;...
      0 0 1 0;...
      0 0 0 1];
alf = ja;  
A9 = [1 0          0         0;...
      0 cosd(alf),  -sind(alf) 0;...
      0 sind(alf), cosd(alf)  0;...
      0 0          0         1];
d = -lengthOfTool;
A10 = [1 0 0 0;...
      0 1 0 0;...
      0 0 1 d;...
      0 0 0 1];
alf = 90;
A11 = [1 0          0         0;...
      0 cosd(alf),  -sind(alf) 0;...
      0 sind(alf), cosd(alf)  0;...
      0 0          0         1];
d = offsetAToolY ;
A12 = [1 0 0 0;...
      0 1 0 0;...
      0 0 1 d;...
      0 0 0 1];
alf = -90;
A13 = [1 0          0         0;...
      0 cosd(alf),  -sind(alf) 0;...
      0 sind(alf), cosd(alf)  0;...
      0 0          0         1];
A = A1*A2*A3*A4*A5*A6*A7*A8*A9*A10*A11*A12*A13;
tcp = [0 0 0 1]';
TCPbase = A*tcp
  